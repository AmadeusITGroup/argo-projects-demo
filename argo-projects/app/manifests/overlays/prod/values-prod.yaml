image:
  version: '3.0'
phase: prod
rollout:
  enabled: true
  strategy:
    canary:
      canaryService: app-prod-my-app-canary-svc
      stableService: app-prod-my-app-svc
      analysis:
        templates:
          - templateName: http-server-success-rate-comparison
            clusterScope: true
        args:
          - name: container-name
            value: app-prod-my-app
          - name: stable-hash
            valueFrom:
              podTemplateHashValue: Stable
          - name: latest-hash
            valueFrom:
              podTemplateHashValue: Latest
      steps:
      - setWeight: 20
      - pause:
          duration: 10s
      - setWeight: 40
      - pause:
          duration: 40s
      - setWeight: 60
      - pause:
          duration: 20s
      - setWeight: 80
      - pause:
          duration: 20s
      trafficRouting:
        nginx:
          stableIngress: app-prod-my-app-ingress
